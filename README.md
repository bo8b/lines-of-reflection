# lines-of-reflection

This project relies on a few external components, namely Google APIs for [Speech-to-Text](https://cloud.google.com/speech-to-text/docs/reference/rest/?apix=true) and [Text-to-Speech](https://cloud.google.com/text-to-speech/docs/reference/rest/?apix=true) as well as the [MagicMirror² open-source platform](https://magicmirror.builders/).

* Most of the heavy lifting is accomplished within the lor.py Python script.  This deals with most of the voice recognition as well as displaying and reading aloud the lines of other actors.
* lines.js and node_helper.js are the files that interface with the MagicMirror² platform for UI display.
* script.csv is a comma-delimited list of two columns.  The first is the character name speaking the line, the second is the line itself.
* role.txt is a text field with one word: the name of the character using this device.  All lines for other people will be displayed, but the lines for the character in this file will be listened for and passed only when the system determines the spoken words are relatively close to the written line in the script file, above.
* output.txt is generated by the system when in use.

## To operate this software:

* MagicMirror² should already be running.  On my device, I have it set up to autostart with pm2, but if not, then go to the ~/MagicMirror directory and run `npm start`
* Run the command `sudo stdbuf -o0 python ~/MagicMirror/modules/lines/lor.py > ~/MagicMirror/modules/lines/output.txt`.  (This is located in the file lor.sh, for ease of use.)  This command resets the lines-of-reflection system, reloads the script.csv and role.txt (in case they're changed), and begins running again from the top of the script. 
